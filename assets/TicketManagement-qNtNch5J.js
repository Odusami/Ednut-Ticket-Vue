import{u as F}from"./useTicket-C8VPRBlP.js";import{_ as y,c as l,g as v,a as e,t as d,p as O,o as c,j as C,i as h,q as T,h as f,v as D,n as g,s as S,f as E,d as M,F as q,l as x,w as j,r as w,m as b}from"./index-Cj8QT0-n.js";const N={name:"Modal",props:{isOpen:{type:Boolean,required:!0},onClose:{type:Function,required:!0},title:{type:String,required:!0}},methods:{handleClose(){this.onClose()}}},U={key:0,class:"modal-overlay","data-testid":"modal-overlay"},V={class:"modal"},A={class:"modal-header"},P={"data-testid":"modal-title"},B={class:"modal-content"};function I(n,t,i,s,m,u){return i.isOpen?(c(),l("div",U,[e("div",V,[e("div",A,[e("h2",P,d(i.title),1),e("button",{onClick:t[0]||(t[0]=(...o)=>u.handleClose&&u.handleClose(...o)),class:"modal-close","data-testid":"modal-close"}," âœ• ")]),e("div",B,[O(n.$slots,"default")])])])):v("",!0)}const L=y(N,[["render",I]]),z={name:"TicketForm",props:{ticket:{type:Object,default:null},onSuccess:{type:Function,required:!0},onCancel:{type:Function,required:!0}},setup(n){const t=C({title:"",description:"",status:"open",priority:"medium"}),i=C({}),s=h(!1),{createTicket:m,updateTicket:u}=F();T(()=>n.ticket,a=>{a?Object.assign(t,{title:a.title||"",description:a.description||"",status:a.status||"open",priority:a.priority||"medium"}):Object.assign(t,{title:"",description:"",status:"open",priority:"medium"}),Object.keys(i).forEach(k=>delete i[k])},{immediate:!0});const o=()=>(Object.keys(i).forEach(a=>delete i[a]),t.title.trim()||(i.title="Title is required"),t.status?["open","in_progress","closed"].includes(t.status)||(i.status="Invalid status value"):i.status="Status is required",Object.keys(i).length===0),_=async()=>{if(o()){s.value=!0;try{n.ticket?await u(n.ticket.id,{...t}):await m({...t}),n.onSuccess()}catch{}finally{s.value=!1}}};return T(t,(a,k)=>{for(const p in a)a[p]!==k[p]&&i[p]&&delete i[p]}),{formData:t,errors:i,loading:s,handleSubmit:_}}},H={class:"form-group"},Y={key:0,class:"error-message","data-testid":"title-error"},G={class:"form-group"},J={class:"form-row"},K={class:"form-group"},Q={key:0,class:"error-message","data-testid":"status-error"},R={class:"form-group"},W={class:"form-actions"},X=["disabled"];function Z(n,t,i,s,m,u){return c(),l("form",{onSubmit:t[5]||(t[5]=E((...o)=>s.handleSubmit&&s.handleSubmit(...o),["prevent"])),class:"ticket-form","data-testid":"ticket-form"},[e("div",H,[t[6]||(t[6]=e("label",{for:"title"},"Title *",-1)),f(e("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=o=>s.formData.title=o),class:g({error:s.errors.title}),placeholder:"Enter ticket title","data-testid":"title-input"},null,2),[[D,s.formData.title]]),s.errors.title?(c(),l("div",Y,d(s.errors.title),1)):v("",!0)]),e("div",G,[t[7]||(t[7]=e("label",{for:"description"},"Description",-1)),f(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=o=>s.formData.description=o),rows:"4",placeholder:"Enter ticket description","data-testid":"description-input"},null,512),[[D,s.formData.description]])]),e("div",J,[e("div",K,[t[9]||(t[9]=e("label",{for:"status"},"Status *",-1)),f(e("select",{id:"status","onUpdate:modelValue":t[2]||(t[2]=o=>s.formData.status=o),class:g({error:s.errors.status}),"data-testid":"status-select"},[...t[8]||(t[8]=[e("option",{value:"open"},"Open",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"closed"},"Closed",-1)])],2),[[S,s.formData.status]]),s.errors.status?(c(),l("div",Q,d(s.errors.status),1)):v("",!0)]),e("div",R,[t[11]||(t[11]=e("label",{for:"priority"},"Priority",-1)),f(e("select",{id:"priority","onUpdate:modelValue":t[3]||(t[3]=o=>s.formData.priority=o),"data-testid":"priority-select"},[...t[10]||(t[10]=[e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"urgent"},"Urgent",-1)])],512),[[S,s.formData.priority]])])]),e("div",W,[e("button",{type:"button",onClick:t[4]||(t[4]=(...o)=>i.onCancel&&i.onCancel(...o)),class:"btn btn--secondary","data-testid":"cancel-btn"}," Cancel "),e("button",{type:"submit",class:"btn btn--primary",disabled:s.loading,"data-testid":"submit-btn"},d(s.loading?"Saving...":i.ticket?"Update Ticket":"Create Ticket"),9,X)])],32)}const $=y(z,[["render",Z]]),tt={name:"TicketManagement",components:{Modal:L,TicketForm:$},setup(){const n=h(!1),t=h(null),{tickets:i,deleteTicket:s}=F(),m=b(()=>i.value.filter(r=>r.status==="open").length),u=b(()=>i.value.filter(r=>r.status==="in_progress").length),o=b(()=>i.value.filter(r=>r.status==="closed").length);return{showModal:n,editingTicket:t,tickets:i,openTicketsCount:m,inProgressTicketsCount:u,closedTicketsCount:o,handleCreateTicket:()=>{t.value=null,n.value=!0},handleEditTicket:r=>{t.value=r,n.value=!0},handleDeleteTicket:async r=>{window.confirm("Are you sure you want to delete this ticket?")&&await s(r)},handleCloseModal:()=>{n.value=!1,t.value=null},handleFormSuccess:()=>{n.value=!1,t.value=null},formatDate:r=>new Date(r).toLocaleDateString()}}},et={class:"ticket-management","data-testid":"ticket-management"},st={class:"container"},at={class:"page-header"},it={class:"ticket-stats","data-testid":"ticket-stats"},ot={class:"stat-item"},nt={class:"stat-number","data-testid":"total-tickets"},dt={class:"stat-item"},rt={class:"stat-number","data-testid":"open-tickets"},lt={class:"stat-item"},ct={class:"stat-number","data-testid":"in-progress-tickets"},ut={class:"stat-item"},mt={class:"stat-number","data-testid":"closed-tickets"},kt={key:0,class:"empty-state empty-t-ticket","data-testid":"no-tickets-state"},pt={key:1,class:"tickets-grid","data-testid":"tickets-grid"},_t=["data-testid"],ft={class:"ticket-card__header"},vt={class:"ticket-card__title","data-testid":"ticket-card-title"},gt={class:"ticket-card__badges"},bt={class:"ticket-card__description","data-testid":"ticket-card-description"},ht={class:"ticket-card__meta"},yt={"data-testid":"ticket-card-created"},Ct={key:0,"data-testid":"ticket-card-updated"},Tt={class:"ticket-card__actions"},Dt=["onClick","data-testid"],St=["onClick","data-testid"];function Mt(n,t,i,s,m,u){const o=w("TicketForm"),_=w("Modal");return c(),l("div",et,[e("div",st,[e("div",at,[t[2]||(t[2]=e("div",{class:"page-header__content"},[e("h1",{class:"page-title","data-testid":"ticket-management-title"}," Ticket Management "),e("p",{class:"page-subtitle"}," Manage and track all support tickets in one place ")],-1)),e("button",{onClick:t[0]||(t[0]=(...a)=>s.handleCreateTicket&&s.handleCreateTicket(...a)),class:"btn btn--primary pad-btn","data-testid":"create-ticket-btn"}," Create New Ticket ")]),e("div",it,[e("div",ot,[e("span",nt,d(s.tickets.length),1),t[3]||(t[3]=e("span",{class:"stat-label"},"Total Tickets",-1))]),e("div",dt,[e("span",rt,d(s.openTicketsCount),1),t[4]||(t[4]=e("span",{class:"stat-label"},"Open",-1))]),e("div",lt,[e("span",ct,d(s.inProgressTicketsCount),1),t[5]||(t[5]=e("span",{class:"stat-label"},"In Progress",-1))]),e("div",ut,[e("span",mt,d(s.closedTicketsCount),1),t[6]||(t[6]=e("span",{class:"stat-label"},"Closed",-1))])]),s.tickets.length===0?(c(),l("div",kt,[t[7]||(t[7]=e("div",{class:"empty-state__icon"},"ðŸŽ«",-1)),t[8]||(t[8]=e("h3",null,"No tickets yet",-1)),t[9]||(t[9]=e("p",null,"Create your first ticket to get started with ticket management.",-1)),e("button",{onClick:t[1]||(t[1]=(...a)=>s.handleCreateTicket&&s.handleCreateTicket(...a)),class:"btn btn--primary margin-t pad-btn"}," Create Your First Ticket ")])):(c(),l("div",pt,[(c(!0),l(q,null,x(s.tickets,a=>(c(),l("div",{key:a.id,class:"ticket-card","data-testid":`ticket-card-${a.id}`},[e("div",ft,[e("h3",vt,d(a.title),1),e("div",gt,[e("span",{class:g(`status-badge status-badge--${a.status}`),"data-testid":"ticket-card-status"},d(a.status.replace("_"," ")),3),e("span",{class:g(`priority-badge priority-badge--${a.priority}`),"data-testid":"ticket-card-priority"},d(a.priority),3)])]),e("p",bt,d(a.description||"No description provided"),1),e("div",ht,[e("span",yt," Created: "+d(s.formatDate(a.createdAt)),1),a.updatedAt!==a.createdAt?(c(),l("span",Ct," Updated: "+d(s.formatDate(a.updatedAt)),1)):v("",!0)]),e("div",Tt,[e("button",{onClick:k=>s.handleEditTicket(a),class:"btn btn--secondary btn--small","data-testid":`edit-ticket-${a.id}`}," Edit ",8,Dt),e("button",{onClick:k=>s.handleDeleteTicket(a.id),class:"btn btn--danger btn--small","data-testid":`delete-ticket-${a.id}`}," Delete ",8,St)])],8,_t))),128))])),M(_,{isOpen:s.showModal,onClose:s.handleCloseModal,title:s.editingTicket?"Edit Ticket":"Create New Ticket"},{default:j(()=>[M(o,{ticket:s.editingTicket,onSuccess:s.handleFormSuccess,onCancel:s.handleCloseModal},null,8,["ticket","onSuccess","onCancel"])]),_:1},8,["isOpen","onClose","title"])])])}const qt=y(tt,[["render",Mt]]);export{qt as default};
